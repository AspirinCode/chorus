

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MCS finder &mdash; chemex 0.7 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="chemex 0.7 documentation" href="index.html"/>
        <link rel="prev" title="Substructure search" href="chemex.substructure.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> chemex
          

          
          </a>

          
            
            
              <div class="version">
                0.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="model/index.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="draw/index.html">Draw</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility/index.html">Utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemex.smilessupplier.html">Smiles import</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemex.v2000supplier.html">CTAB(.mol, .sdf) import - v2000supplier</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemex.atomtyper.html">Atomtyper</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemex.substructure.html">Substructure search</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">MCS finder</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">chemex</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>MCS finder</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/chemex.drmcs.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-chemex.drmcs">
<span id="mcs-finder"></span><h1>MCS finder<a class="headerlink" href="#module-chemex.drmcs" title="Permalink to this headline">¶</a></h1>
<p>Diameter-restricted maximal common substructure (DRMCS)</p>
<p>This finds maximum common edge subgraph (MCES) between two molecule
by using the algorithm based on maximum clique detection in the modular
product graph of the two molecule.</p>
<p>Seiji Matsuoka (2015) All Rights Reserved.</p>
<dl class="function">
<dt id="chemex.drmcs.comparison_array">
<tt class="descname">comparison_array</tt><big>(</big><em>molecule</em>, <em>diameter=10</em>, <em>size=30</em><big>)</big><a class="headerlink" href="#chemex.drmcs.comparison_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate comparison array
Comparison array made of node pairs in the graph and attribute collater.
42 bit collater</p>
<blockquote>
<div><p>6 bit of distance (0-31)
18 bit of bond attribute x2</p>
<blockquote>
<div><dl class="docutils">
<dt>9 bit of atom attribute x 2</dt>
<dd>7 bit of atom number (0-127)
2 bit of atom pi(0-3)</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p>Distance limitation is important to reduce calculation order.
[Sheridan, R.P. and Miller, M.D., J. Chem. Inf. Comput. Sci. 38 (1998) 915]</p>
<p>Using possible_path_length instead of shortest_path_length
and find intersection of the distance set each other,
it is possible to detect roundabout matching path.
Therefore, exact graph isomorphism can be determined.
However, set intersection is too costful to do
in spite of a trivial improvement.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mol</strong> &#8211; Compound</li>
<li><strong>cutoff</strong> &#8211; more distant connection than the value is no longer used
for comparison matrix graph due to performance reason.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>arr</strong> &#8211; comparison array. list of tuple (node1, node2, collater)
max_mcs(int): maximum size of possible mcs
int_to_node(dict): int -&gt; node index pair reconverter dict</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Throws:</dt>
<dd>ValueError: if len(mol) &lt; 3</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="chemex.drmcs.comparison_graph">
<tt class="descname">comparison_graph</tt><big>(</big><em>arr1</em>, <em>arr2</em><big>)</big><a class="headerlink" href="#chemex.drmcs.comparison_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate comparison graph
Comparison graph is a modular product of molecule edges</p>
</dd></dl>

<dl class="function">
<dt id="chemex.drmcs.mcs_score">
<tt class="descname">mcs_score</tt><big>(</big><em>arr1</em>, <em>arr2</em><big>)</big><a class="headerlink" href="#chemex.drmcs.mcs_score" title="Permalink to this definition">¶</a></dt>
<dd><p>return mcs node count</p>
</dd></dl>

<dl class="function">
<dt id="chemex.drmcs.mcs_dist">
<tt class="descname">mcs_dist</tt><big>(</big><em>arr1</em>, <em>arr2</em><big>)</big><a class="headerlink" href="#chemex.drmcs.mcs_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>return Jaccard distance based on mcs score</p>
</dd></dl>

<dl class="function">
<dt id="chemex.drmcs.mp_mcs_dist">
<tt class="descname">mp_mcs_dist</tt><big>(</big><em>idx1</em>, <em>idx2</em>, <em>arr1</em>, <em>arr2</em><big>)</big><a class="headerlink" href="#chemex.drmcs.mp_mcs_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>return Jaccard distance based on mcs score.
this also returns idx of both molecule for parallel calc</p>
</dd></dl>

<dl class="function">
<dt id="chemex.drmcs.mcs_structure">
<tt class="descname">mcs_structure</tt><big>(</big><em>mol1</em>, <em>mol2</em><big>)</big><a class="headerlink" href="#chemex.drmcs.mcs_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>return mol object of mol1 &amp;&amp; mol2</p>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="chemex.substructure.html" class="btn btn-neutral" title="Substructure search" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Seiji Matsuoka.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>