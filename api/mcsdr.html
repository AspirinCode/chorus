

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>chorus.mcsdr &mdash; chorus 0.9.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="chorus 0.9.0 documentation" href="../index.html"/>
        <link rel="up" title="API references" href="api.html"/>
        <link rel="next" title="chorus.rdkit" href="rdkit.html"/>
        <link rel="prev" title="chorus.substructure" href="substructure.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> chorus
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cook book</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API references</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model.atom.html">chorus.model.atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.bond.html">chorus.model.bond</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.graphmol.html">chorus.model.graphmol</a></li>
<li class="toctree-l2"><a class="reference internal" href="draw.drawable.html">chorus.draw.drawable</a></li>
<li class="toctree-l2"><a class="reference internal" href="draw.drawer2d.html">chorus.draw.drawer2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="draw.svg.html">chorus.draw.svg</a></li>
<li class="toctree-l2"><a class="reference internal" href="draw.matplotlib.html">chorus.draw.matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="draw.helper.html">chorus.draw.helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="draw.calc2dcoords.html">chorus.draw.calc2dcoords</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.geometry.html">chorus.util.geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.iterator.html">chorus.util.iterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.text.html">chorus.util.text</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.debug.html">chorus.util.debug</a></li>
<li class="toctree-l2"><a class="reference internal" href="smilessupplier.html">chorus.smilessupplier</a></li>
<li class="toctree-l2"><a class="reference internal" href="v2000reader.html">chorus.v2000reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="v2000writer.html">chorus.v2000writer</a></li>
<li class="toctree-l2"><a class="reference internal" href="molutil.html">chorus.molutil</a></li>
<li class="toctree-l2"><a class="reference internal" href="topology.html">chorus.topology</a></li>
<li class="toctree-l2"><a class="reference internal" href="remover.html">chorus.remover</a></li>
<li class="toctree-l2"><a class="reference internal" href="descriptor.html">chorus.descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="wclogp.html">chorus.wclogp</a></li>
<li class="toctree-l2"><a class="reference internal" href="substructure.html">chorus.substructure</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">chorus.mcsdr</a></li>
<li class="toctree-l2"><a class="reference internal" href="rdkit.html">chorus.rdkit</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chorus</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="api.html">API references</a> &raquo;</li>
        
      <li>chorus.mcsdr</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/mcsdr.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-chorus.mcsdr">
<span id="chorus-mcsdr"></span><h1>chorus.mcsdr<a class="headerlink" href="#module-chorus.mcsdr" title="Permalink to this headline">¶</a></h1>
<p>Maximal Common Substructure with Diameter Restriction (MCS-DR)</p>
<p>This calculetes maximum common edge subgraph (MCES) between two molecule
by using the algorithm based on maximum clique detection in the modular
product graph of the two molecule.
Diameter restriction is used for fast and stable local MCS estimation
and for common substructure mapping</p>
<dl class="function">
<dt id="chorus.mcsdr.comparison_array">
<code class="descname">comparison_array</code><span class="sig-paren">(</span><em>molecule</em>, <em>diameter=10</em>, <em>size=30</em>, <em>ignore_hydrogen=True</em><span class="sig-paren">)</span><a class="headerlink" href="#chorus.mcsdr.comparison_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate comparison array
Comparison array consists of node pairs in the graph and a collater.
42 bit collater</p>
<blockquote>
<div><p>6 bit of distance (0-31)
18 bit of bond attribute x2</p>
<blockquote>
<div><dl class="docutils">
<dt>9 bit of atom attribute x 2</dt>
<dd>7 bit of atom number (0-127)
2 bit of atom pi(0-3)</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p>[Sheridan, R.P. and Miller, M.D., J. Chem. Inf. Comput. Sci. 38 (1998) 915]</p>
<p>Using possible_path_length instead of shortest_path_length
and find intersection of the distance set each other,
it is possible to detect roundabout matching path.
Therefore, exact graph isomorphism can be determined.
However, set intersection is too costful to do
in spite of a trivial improvement.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mol</strong> – Compound</li>
<li><strong>cutoff</strong> – more distant connection than the value is no longer used
for comparison matrix graph due to performance reason.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">comparison array. list of tuple (node1, node2, collater)
max_mcs(int): maximum size of possible mcs
int_to_node(dict): int -&gt; node index pair reconverter dict</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">arr(list)</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Throws:</dt>
<dd>ValueError: if len(mol) &lt; 3</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="chorus.mcsdr.comparison_graph_py">
<code class="descname">comparison_graph_py</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em><span class="sig-paren">)</span><a class="headerlink" href="#chorus.mcsdr.comparison_graph_py" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate comparison graph
Comparison graph is a modular product of molecule edges</p>
</dd></dl>

<dl class="function">
<dt id="chorus.mcsdr.mcsdr_edge_count">
<code class="descname">mcsdr_edge_count</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em><span class="sig-paren">)</span><a class="headerlink" href="#chorus.mcsdr.mcsdr_edge_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns mcsdr edge count</p>
</dd></dl>

<dl class="function">
<dt id="chorus.mcsdr.local_sim">
<code class="descname">local_sim</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>digit=3</em><span class="sig-paren">)</span><a class="headerlink" href="#chorus.mcsdr.local_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph-based local similarity(GLS) index</p>
</dd></dl>

<dl class="function">
<dt id="chorus.mcsdr.mcs_structure">
<code class="descname">mcs_structure</code><span class="sig-paren">(</span><em>mol1</em>, <em>mol2</em><span class="sig-paren">)</span><a class="headerlink" href="#chorus.mcsdr.mcs_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>return mol object of mol1 &amp;&amp; mol2</p>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rdkit.html" class="btn btn-neutral float-right" title="chorus.rdkit" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="substructure.html" class="btn btn-neutral" title="chorus.substructure" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Seiji Matsuoka.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.9.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>